<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>QQI Programme Schedule Template</title>
    <style>
      body {
        font-family: Calibri, sans-serif;
        margin: 15pt;
        background-color: #f5f5f5;
      }
      table {
        width: 100%;
        border-collapse: collapse;
        background-color: white;
        margin-bottom: 15pt;
      }
      th,
      td {
        border: 1pt solid #000;
        padding: 4.5pt;
        text-align: left;
        font-size: 8pt;
      }
      th {
        background-color: #d9e1f2;
        font-weight: bold;
      }
      .form-section-title {
        background-color: #d9e1f2;
        font-weight: bold;
      }
      .label-cell {
        background-color: #e7e6e6;
        font-weight: bold;
      }
      .checkbox-label {
        background-color: #f2f2f2;
        font-weight: bold;
      }
      .instruction-text {
        font-size: 7.5pt;
        color: #333;
      }
      .empty-data {
        background-color: #ffffff;
        min-height: 15pt;
      }
      h1 {
        color: #333;
        font-size: 14pt;
        margin-bottom: 15pt;
      }
      #upload-section {
        background-color: white;
        padding: 11pt;
        margin-bottom: 15pt;
        border: 2pt dashed #ccc;
        border-radius: 3pt;
        transition:
          border-color 0.2s,
          background-color 0.2s;
      }
      #upload-section.drag-over {
        border-color: #4a90d9;
        background-color: #f0f7ff;
      }
      #upload-section label {
        font-weight: bold;
        margin-right: 7.5pt;
      }
      .drop-hint {
        color: #666;
        font-size: 9pt;
        margin-left: 7.5pt;
      }
      #upload-status {
        margin-left: 11pt;
        font-style: italic;
      }
      .success {
        color: green;
      }
      .error {
        color: red;
      }
      .checked::after {
        content: " ✔";
      }
      #schedules-container,
      #module-descriptors-container {
        max-width: 260mm; /* A4 landscape width */
      }
      .page-break {
        page-break-after: always;
        margin-top: 30pt;
      }
      .section-title {
        color: #2e75b6;
        font-size: 14pt;
        font-weight: bold;
        margin-top: 20pt;
        margin-bottom: 10pt;
        border-bottom: 2pt solid #2e75b6;
        padding-bottom: 4pt;
      }
      table.module-descriptor {
        margin-bottom: 20pt;
        width: 100%;
        table-layout: fixed;
      }
      table.module-descriptor td {
        vertical-align: top;
        padding: 4pt;
        border: 1pt solid #000;
      }
      table.module-descriptor .section-header {
        background-color: #e7e6e6;
        font-weight: normal;
      }
      table.module-descriptor .section-subheader {
        background-color: #e7e6e6;
        font-weight: bold;
      }
      table.module-descriptor .subsection-header {
        background-color: #f2f2f2;
        font-weight: bold;
      }
      table.module-descriptor .label-cell {
        background-color: #d9e2f3;
        font-weight: bold;
      }
      table.module-descriptor .data-cell {
        background-color: #ffffff;
      }
      table.module-descriptor .modality-label {
        background-color: #ffffff;
      }
      table.module-descriptor .content-area {
        min-height: 50pt;
      }
      .placeholder-text {
        color: #666;
        font-style: italic;
        padding: 15pt;
        background-color: #f9f9f9;
        border: 1pt dashed #ccc;
        text-align: center;
      }
      .vertical-header {
        vertical-align: middle;
        text-align: center;
        padding: 0;
        height: 75pt;
      }
      .vertical-header span {
        writing-mode: vertical-rl;
        transform: rotate(180deg);
        display: inline-block;
        height: 70pt;
        overflow: hidden;
        padding: 2pt;
        font-size: 7pt;
        line-height: 1.2;
        text-align: left;
      }
    </style>
  </head>
  <body>
    <h1>QQI Programme Schedule Template</h1>

    <div id="upload-section">
      <label for="file-upload">Upload Programme JSON:</label>
      <input type="file" id="file-upload" accept=".json" />
      <span class="drop-hint">(or drag and drop a file here)</span>
      <button
        type="button"
        id="copy-btn"
        style="margin-left: 11pt; padding: 4.5pt 9pt; cursor: pointer"
      >
        Copy All
      </button>
      <button
        type="button"
        id="download-docx-btn"
        style="margin-left: 7.5pt; padding: 4.5pt 9pt; cursor: pointer"
      >
        Download DOCX
      </button>
      <span id="upload-status"></span>
    </div>

    <div id="schedules-container">
      <p class="placeholder-text">Upload a programme JSON file to generate programme schedules.</p>
    </div>

    <!-- Section 7: Module Descriptors -->
    <div id="module-descriptors-container">
      <p class="placeholder-text">Upload a programme JSON file to generate module descriptors.</p>
    </div>

    <!-- NOTES -->
    <div
      style="
        font-size: 8pt;
        color: #666;
        margin-top: 15pt;
        padding: 7.5pt;
        background-color: #f9f9f9;
        border: 1pt solid #ddd;
      "
    >
      <strong>INSTRUCTIONS FOR USE:</strong>
      <ul>
        <li>Upload a programme JSON file to automatically populate the schedule tables</li>
        <li>
          A separate schedule table will be generated for each stage in each programme version
        </li>
        <li>Copy rows and paste below to add additional module data rows</li>
        <li>
          Copy the entire table to create schedules for different stages or programme versions
        </li>
        <li>
          Mark checkboxes (✔) in delivery modes, teaching modalities, and assessment techniques rows
        </li>
      </ul>
    </div>

    <script type="module" src="/src/template.js"></script>
  </body>
</html>
